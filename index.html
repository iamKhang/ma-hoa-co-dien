<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mini Project Nhập môn an toàn thông tin</title>
    <link rel="stylesheet" href="./css/base.css" />
    <link rel="stylesheet" href="./lib/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <script src="./js/playfair.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.2.1/jsencrypt.min.js"></script>
  </head>
  <body>
    <header id="header-page" class="text-white py-4">
      <div class="container">
        <div class="header-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <h1 class="display-4">Thuật toán mã hóa cổ điển</h1>
        <p class="lead">
          <i class="fas fa-lock"></i>
          Trực quan hóa các thuật toán mã hóa cơ bản
        </p>
        <div class="header-info">
          <p>
            <i class="fas fa-book"></i>
            Môn học: Nhập môn an toàn thông tin
          </p>
          <p>
            <i class="fas fa-user"></i>
            Lê Hoàng Khang | 
            <a href="mailto:iamhoangkhang@icloud.com" class="text-white">
              <i class="fas fa-envelope"></i>
              iamhoangkhang@icloud.com
            </a>
          </p>
        </div>
      </div>
    </header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
      <div class="container">
        <a class="navbar-brand" href="#">
          <i class="fas fa-shield-alt"></i> 
          Crypto Algorithms
        </a>
        <button class="navbar-toggler" type="button" 
                data-bs-toggle="collapse" 
                data-bs-target="#navbarNav" 
                aria-controls="navbarNav" 
                aria-expanded="false" 
                aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="#" data-target="ham-bam">
                <i class="fas fa-hash"></i> MD5
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-target="ma-hoa-caesar">
                <i class="fas fa-exchange-alt"></i> Caesar
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-target="ma-hoa-playfair">
                <i class="fas fa-table"></i> Playfair
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-target="ma-hoa-vigerane">
                <i class="fas fa-key"></i> Vigenère
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-target="ma-hoa-bcrypt">
                <i class="fas fa-lock"></i> Bcrypt
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-target="ma-hoa-aes">
                <i class="fas fa-sync-alt"></i> AES
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" data-target="ma-hoa-rsa">
                <i class="fas fa-key"></i> RSA
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div>
      <!-- <div id="sinh-khoa-RSA" class="container content" style="display: none">
     
        <div class="">
          <header class="mt-3 mb-3">
            Tìm các số nguyên tố cùng nhau với (p-1)*(q-1)
          </header>
          <div class="row">
            <div class="form-group col-6">
              <label>p</label>
              <textarea
                class="form-control"
                id="text-p-search"
                cols="30"
              ></textarea>
            </div>
            <div class="form-group col-6">
              <label>q</label>
              <textarea
                class="form-control"
                id="text-q-search"
                cols="30"
              ></textarea>
            </div>
          </div>
          <div class="form-group">
            <label>Một số số nguyên tố cùng nhau với (p-1)*(q-1)</label>
            <textarea
              class="form-control"
              id="list-e"
              cols="30"
            ></textarea>
          </div>
          <div class="form-group d-flex justify-content-center">
            <button
              type="button"
              class="btn-primary m-1"
              onclick="btnGetListPrime()"
            >
              Tìm kiếm
            </button>
          </div>
        </div>
        <div class="">
          <header class="mt-3 mb-3">Phát sinh khóa bằng thuật toán RSA</header>

          <div class="row">
            <div class="form-group col-4">
              <label>p:</label>
              <textarea
                class="form-control"
                id="text-p"
                cols="30"
              ></textarea>
            </div>
            <div class="form-group col-4">
              <label>q:</label>
              <textarea
                class="form-control"
                id="text-q"
                cols="30"
              ></textarea>
            </div>
            <div class="form-group col-4">
              <label>E:</label>
              <textarea
                class="form-control"
                id="text-e"
                cols="30"
              ></textarea>
            </div>
          </div>
          <div class="form-group">
            <label>Khóa công khai:</label>
            <textarea
              class="form-control"
              id="publicKey"
              cols="30"
            ></textarea>
          </div>
          <div class="form-group">
            <label>Khóa riêng:</label>
            <textarea
              class="form-control"
              id="privateKey"
              cols="30"
            ></textarea>
          </div>
          <div class="form-group d-flex justify-content-center">
            <button
              type="button"
              class="btn-primary m-1"
              onclick="btnGenerateKey()"
            >
              Sinh khóa
            </button>
          </div>
        </div>
      </div> -->

      <div id="ham-bam" class="container content" style="display: none">
        <div class="algorithm-explanation">
          <h3 class="mb-4">Thuật toán băm MD5</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Giới thiệu</h4>
                <p>MD5 (Message-Digest Algorithm 5) là một hàm băm mật mã học tạo ra giá trị hash 128-bit. Thuật toán này được sử dụng rộng rãi để kiểm tra tính toàn vẹn của dữ liệu và lưu trữ mật khẩu.</p>
              </div>
            </div>
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Đặc điểm</h4>
                <ul>
                  <li>Tạo ra một chuỗi hash 32 ký tự hex</li>
                  <li>Một chiều - không thể giải mã ngược lại</li>
                  <li>Cùng input luôn cho ra cùng output</li>
                  <li>Thay đổi nhỏ ở input sẽ thay đổi lớn ở output</li>
                </ul>
              </div>
            </div>
          </div>
          
          <div class="row mt-4">
            <div class="col-12">
              <div class="explanation-card">
                <h4>Quá trình Hash MD5</h4>
                <div class="md5-process">
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="step-label">Input Message</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-puzzle-piece"></i>
                    </div>
                    <div class="step-label">Padding</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-random"></i>
                    </div>
                    <div class="step-label">Processing</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-fingerprint"></i>
                    </div>
                    <div class="step-label">128-bit Hash</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="algorithm-demo mt-5">
          <h4>Demo thuật toán</h4>
          <div class="form-group">
            <label>Plain text - Chuỗi chưa mã hóa:</label>
            <textarea class="form-control" id="plainTextMD5" cols="30"></textarea>
          </div>
          <div class="form-group">
            <label>Cipher text - Chuỗi sau khi mã hóa:</label>
            <textarea
              class="form-control"
              id="cipherTextMD5"
              cols="30"
            ></textarea>
          </div>
          <div class="form-group d-flex justify-content-center">
            <button
              type="button"
              class="btn-primary m-1"
              onclick="btnEncryptMD5()"
            >
              Encrypt
            </button>
          </div>
        </div>
      </div>
      <div id="ma-hoa-caesar" class="container content" style="display: none">
        <div class="algorithm-explanation">
          <h3 class="mb-4">Mã hóa Caesar</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Nguyên lý hoạt động</h4>
                <p>Mã Caesar là một loại mật mã thay thế, trong đó mỗi ký tự trong văn bản gốc được thay thế bằng một ký tự cách nó một khoảng xác định trong bảng chữ cái.</p>
                <div class="caesar-visual">
                  <div class="shift-example">
                    <div class="shift-row">
                      <span class="label">Original:</span>
                      <div class="alphabet original">
                        A B C D E F G H I J
                      </div>
                    </div>
                    <div class="shift-arrow">↓ shift 3</div>
                    <div class="shift-row">
                      <span class="label">Shifted:</span>
                      <div class="alphabet shifted">
                        D E F G H I J K L M
                      </div>
                    </div>
                  </div>
                  <div class="example-text mt-3">
                    <p class="mb-1">Example: <span class="text-primary">"HELLO"</span> → <span class="text-success">"KHOOR"</span></p>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Công thức</h4>
                <div class="formula">
                  <p>Mã hóa: E(x) = (x + k) mod 26</p>
                  <p>Giải mã: D(x) = (x - k) mod 26</p>
                  <p>Trong đó:</p>
                  <ul>
                    <li>x: vị trí của ký tự trong bảng chữ cái (A=0, B=1,...)</li>
                    <li>k: khóa (số bước dịch chuyển)</li>
                    <li>mod 26: phép chia lấy dư cho 26 (số ký tự trong bảng chữ cái)</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="algorithm-demo mt-5">
          <h4>Demo thuật toán</h4>
          <div class="form-group">
            <label for="plainTextCaesar">Plain text - Chuỗi chưa mã hóa:</label>
            <textarea
              class="form-control"
              id="plainTextCaesar"
              cols="30"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="cipherTextCaesar"
              >Cipher text - Chuỗi sau khi mã hóa:</label
            >
            <textarea
              class="form-control"
              id="cipherTextCaesar"
              cols="30"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="keyCaesar">Key K:</label>
            <input
              title="Nhập một kí tự từ A-Z hoặc số từ 1-25"
              type="text"
              class="form-control"
              id="keyCaesar"
              size="1"
              pattern="^[a-zA-Z0-9]{0,1}$"
            />
          </div>
          <div id="errorMsgCaesar" class="error"></div>
          <div class="mb-3 d-flex justify-content-center">
            <button
              type="button"
              class="btn btn-success m-1"
              onclick="btnEncryptCaesar()"
            >
              Encrypt
            </button>
            <button
              type="button"
              class="btn btn-primary m-1"
              onclick="btnDecryptCaesar()"
            >
              Decrypt
            </button>
          </div>
          <section id="resultBruteforceCaesar"></section>
        </div>
      </div>
      <div id="ma-hoa-playfair" class="container content" style="display: none">
        <div class="algorithm-explanation">
          <h3 class="mb-4">Mã hóa Playfair</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Nguyên lý hoạt động</h4>
                <p>Playfair là một mật mã thay thế sử dụng ma trận 5x5 các chữ cái (I/J được gộp chung). Văn bản được chia thành các cặp chữ cái và mã hóa theo quy tắc:</p>
                <ul>
                  <li>Cùng hàng: thay bằng ký tự bên phải</li>
                  <li>Cùng cột: thay bằng ký t��� bên dưới</li>
                  <li>Tạo hình chữ nhật: thay bằng ký tự ở góc còn lại</li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Quy tắc tạo khóa</h4>
                <ol>
                  <li>Điền từ khóa vào ma trận (bỏ ký tự trùng)</li>
                  <li>Điền các chữ cái còn lại theo thứ tự</li>
                  <li>I và J được xem như nhau</li>
                  <li>Thêm 'X' nếu cặp chữ giống nhau</li>
                </ol>
              </div>
            </div>
          </div>
        </div>

        <div class="algorithm-demo mt-5">
          <h4>Demo thuật toán</h4>
          <div class="row">
            <div class="col-4">
              <label>Khóa K: </label>
              <input
                title="Nhập các kí tự từ A-Z"
                type="text"
                id="keyPlayfair"
                pattern="^[a-zA-Z]+"
                onkeyup="updateMatrixKey()"
                class="form-control"
              />
              <label>Bảng mã Playfair (5x5)</label>
              <table>
                <tr class="playfair">
                  <td class="playfair" id="00"></td>
                  <td class="playfair" id="01"></td>
                  <td class="playfair" id="02"></td>
                  <td class="playfair" id="03"></td>
                  <td class="playfair" id="04"></td>
                </tr>
                <tr class="playfair">
                  <td class="playfair" id="10"></td>
                  <td class="playfair" id="11"></td>
                  <td class="playfair" id="12"></td>
                  <td class="playfair" id="13"></td>
                  <td class="playfair" id="14"></td>
                </tr>
                <tr class="playfair">
                  <td class="playfair" id="20"></td>
                  <td class="playfair" id="21"></td>
                  <td class="playfair" id="22"></td>
                  <td class="playfair" id="23"></td>
                  <td class="playfair" id="24"></td>
                </tr>
                <tr class="playfair">
                  <td class="playfair" id="30"></td>
                  <td class="playfair" id="31"></td>
                  <td class="playfair" id="32"></td>
                  <td class="playfair" id="33"></td>
                  <td class="playfair" id="34"></td>
                </tr>
                <tr class="playfair">
                  <td class="playfair" id="40"></td>
                  <td class="playfair" id="41"></td>
                  <td class="playfair" id="42"></td>
                  <td class="playfair" id="43"></td>
                  <td class="playfair" id="44"></td>
                </tr>
              </table>
            </div>
            <div class="col-7 ml-2">
              <div class="form-group">
                <label>Plain text - Chuỗi chưa mã hóa:</label>
                <textarea
                  id="plainTextPlayfair"
                  cols="30"
                  class="form-control"
                ></textarea>
              </div>
              <div class="form-group">
                <label>Cipher text - Chuỗi sau khi mã hóa: </label>
                <textarea
                  id="cipherTextPlayfair"
                  cols="30"
                  class="form-control"
                ></textarea>
              </div>
              <div id="errorMsgPlayfair" class="error"></div>
              <div class="d-flex align-items-center justify-content-center">
                <button
                  class="m-2 btn-primary"
                  type="button"
                  onclick="btnEncryptPlayfair()"
                >
                  Encrypt
                </button>
                <button
                  class="m-2 btn-success"
                  type="button"
                  onclick="btnDecryptPlayfair()"
                >
                  Decrypt
                </button>
              </div>
              <div class="text-success">
                <b>Lưu ý: </b>kí tự I tương đương kí tự J
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="ma-hoa-vigerane" class="container content" style="display: none">
        <div class="algorithm-explanation">
          <h3 class="mb-4">Mã hóa Vigenère</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Nguyên lý hoạt động</h4>
                <p>Vigenère là một hệ mật mã đa bảng chữ cái, sử dụng các phép dịch Caesar khác nhau dựa trên các chữ cái trong từ khóa.</p>
                <div class="vigenere-visual">
                  <table class="vigenere-table">
                    <thead>
                      <tr>
                        <th></th>
                        <th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- JavaScript sẽ điền nội dung -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Công thức</h4>
                <div class="formula">
                  <p>Mã hóa: Ci = (Pi + Ki) mod 26</p>
                  <p>Giải mã: Pi = (Ci - Ki) mod 26</p>
                  <p>Trong đó:</p>
                  <ul>
                    <li>Ci: ký tự được mã hóa</li>
                    <li>Pi: ký tự gốc</li>
                    <li>Ki: ký tự khóa tương ứng</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="algorithm-demo mt-5">
          <h4>Demo thuật toán</h4>
          <div class="form-group">
            <label>Plain text - Chuỗi chưa mã hóa:</label>
            <textarea
              id="plainTextVigerane"
              cols="30"
              class="form-control"
            ></textarea>
          </div>
          <div class="form-group">
            <label>Cipher text - Chuỗi sau khi mã hóa: </label>
            <textarea
              id="cipherTextVigerane"
              cols="30"
              class="form-control"
            ></textarea>
          </div>
          <div class="form-group">
            <label>Key K: </label>
            <input
              title="Nhập các kí tự từ A-Z"
              type="text"
              id="keyVigerane"
              pattern="^[a-zA-Z]+"
              class="form-control"
            />
          </div>
          <div id="errorMsgVigerane" class="error"></div>
          <div class="d-flex justify-content-center">
            <button
              class="m-2 btn-primary"
              type="button"
              onclick="btnEncryptVigerane()"
            >
              Encrypt
            </button>
            <button
              class="m-2 btn-success"
              type="button"
              onclick="btnDecryptVigerane()"
            >
              Decrypt
            </button>
          </div>
        </div>
      </div>
      <div id="ma-hoa-bcrypt" class="container content" style="display: none">
        <div class="algorithm-explanation">
          <h3 class="mb-4">Thuật toán Bcrypt</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Giới thiệu</h4>
                <p>Bcrypt là một thuật toán mã hóa mật khẩu một chiều, được thiết kế đặc biệt để hash mật khẩu. Thuật toán này tự động tích hợp salt và có thể điều chỉnh độ phức tạp để chống lại các cuộc tấn công brute-force.</p>
              </div>
            </div>
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Đặc điểm</h4>
                <ul>
                  <li>Tự động tạo và quản lý salt</li>
                  <li>Có thể điều chỉnh cost factor</li>
                  <li>Chậm có chủ đích để chống brute-force</li>
                  <li>Format: $2a$[cost]$[22 char salt][31 char hash]</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="row mt-4">
            <div class="col-12">
              <div class="explanation-card">
                <h4>Cấu trúc Hash Bcrypt</h4>
                <div class="bcrypt-structure">
                  <div class="structure-item">
                    <span class="badge bg-primary">$2a$</span>
                    <small>Algorithm Version</small>
                  </div>
                  <div class="structure-item">
                    <span class="badge bg-success">10$</span>
                    <small>Cost Factor</small>
                  </div>
                  <div class="structure-item">
                    <span class="badge bg-info">22 chars</span>
                    <small>Salt</small>
                  </div>
                  <div class="structure-item">
                    <span class="badge bg-warning">31 chars</span>
                    <small>Hash</small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="algorithm-demo mt-5">
          <h4>Demo thuật toán</h4>
          <div class="form-group">
            <label>Password:</label>
            <input type="text" class="form-control" id="plaintextBcrypt" placeholder="Nhập mật khẩu...">
          </div>
          <div class="form-group">
            <label>Salt:</label>
            <input type="text" class="form-control" id="saltBcrypt" readonly>
          </div>
          <div class="form-group">
            <label>Hash:</label>
            <input type="text" class="form-control" id="hashBcrypt" readonly>
          </div>
          <div id="errorMsgBcrypt" class="error"></div>
          <div id="verifyResult" class="text-center mb-3"></div>
          <div class="d-flex justify-content-center">
            <button class="btn btn-primary m-2" onclick="btnBcryptHash()">
              Generate Hash
            </button>
            <button class="btn btn-success m-2" onclick="btnBcryptVerify()">
              Verify Password
            </button>
          </div>
        </div>
      </div>
      <div id="ma-hoa-aes" class="container content" style="display: none">
        <div class="algorithm-explanation">
          <h3 class="mb-4">Mã hóa AES (Advanced Encryption Standard)</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Giới thiệu</h4>
                <p>AES là thuật toán mã hóa đối xứng tiêu chuẩn được sử dụng rộng rãi nhất hiện nay. AES sử dụng cùng một khóa cho cả mã hóa và giải mã, với độ dài khóa có thể là 128, 192 hoặc 256 bit.</p>
              </div>
            </div>
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Đặc điểm</h4>
                <ul>
                  <li>Mã hóa theo khối 128 bit</li>
                  <li>Tốc độ xử lý nhanh</li>
                  <li>An toàn với độ dài khóa đủ lớn</li>
                  <li>Được sử dụng trong HTTPS, SSH, ...</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-12">
              <div class="explanation-card">
                <h4>Quy trình mã hóa AES</h4>
                <div class="aes-process">
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="step-label">Plaintext Block</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-key"></i>
                    </div>
                    <div class="step-label">Key Expansion</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-sync"></i>
                    </div>
                    <div class="step-label">Round Functions</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-lock"></i>
                    </div>
                    <div class="step-label">Ciphertext Block</div>
                  </div>
                </div>
                
                <div class="aes-rounds mt-4">
                  <h5>Các bước trong mỗi vòng:</h5>
                  <div class="round-steps">
                    <div class="round-step">
                      <i class="fas fa-random"></i>
                      <span>SubBytes</span>
                    </div>
                    <div class="round-step">
                      <i class="fas fa-arrows-alt"></i>
                      <span>ShiftRows</span>
                    </div>
                    <div class="round-step">
                      <i class="fas fa-table"></i>
                      <span>MixColumns</span>
                    </div>
                    <div class="round-step">
                      <i class="fas fa-plus"></i>
                      <span>AddRoundKey</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="algorithm-demo mt-5">
          <h4>Demo thuật toán</h4>
          <div class="form-group">
            <label>Plain text:</label>
            <textarea class="form-control" id="plaintextAES" placeholder="Nhập văn bản cần mã hóa..."></textarea>
          </div>
          <div class="form-group">
            <label>Key (16 ký tự cho AES-128):</label>
            <input type="text" class="form-control" id="keyAES" maxlength="16" placeholder="Nhập khóa...">
          </div>
          <div class="form-group">
            <label>Cipher text:</label>
            <textarea class="form-control" id="ciphertextAES" readonly></textarea>
          </div>
          <div id="errorMsgAES" class="error"></div>
          <div class="d-flex justify-content-center">
            <button class="btn btn-primary m-2" onclick="btnEncryptAES()">
              Encrypt
            </button>
            <button class="btn btn-success m-2" onclick="btnDecryptAES()">
              Decrypt
            </button>
          </div>
        </div>
      </div>
      <div id="ma-hoa-rsa" class="container content" style="display: none">
        <div class="algorithm-explanation">
          <h3 class="mb-4">Mã hóa RSA (Rivest-Shamir-Adleman)</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Giới thiệu</h4>
                <p>RSA là thuật toán mã hóa bất đối xứng được sử dụng rộng rãi nhất hiện nay. Thuật toán sử dụng cặp khóa công khai và khóa riêng tư, dựa trên độ khó của bài toán phân tích số nguyên thành tích các số nguyên tố.</p>
              </div>
            </div>
            <div class="col-md-6">
              <div class="explanation-card">
                <h4>Đặc điểm</h4>
                <ul>
                  <li>Sử dụng cặp khóa công khai/riêng tư</li>
                  <li>An toàn dựa trên bài toán phân tích số nguyên tố</li>
                  <li>Tốc độ chậm hơn mã hóa đối xứng</li>
                  <li>Thường dùng để trao đổi khóa và chữ ký số</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-12">
              <div class="explanation-card">
                <h4>Quy trình mã hóa RSA</h4>
                <div class="rsa-process">
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-calculator"></i>
                    </div>
                    <div class="step-label">Tạo số nguyên tố p, q</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-cogs"></i>
                    </div>
                    <div class="step-label">Tính n = p×q, φ(n)</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-key"></i>
                    </div>
                    <div class="step-label">Chọn e, tính d</div>
                  </div>
                  <div class="step-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                  <div class="process-step">
                    <div class="step-icon">
                      <i class="fas fa-lock"></i>
                    </div>
                    <div class="step-label">Tạo cặp khóa</div>
                  </div>
                </div>
                
                <div class="rsa-keys mt-4">
                  <h5>Cặp khóa RSA:</h5>
                  <div class="key-info">
                    <div class="key-item">
                      <span class="badge bg-success">Khóa công khai</span>
                      <p>(e, n)</p>
                    </div>
                    <div class="key-item">
                      <span class="badge bg-danger">Khóa riêng tư</span>
                      <p>(d, n)</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-12">
              <div class="explanation-card">
                <h4>Ví dụ minh họa thuật toán RSA</h4>
                <div class="rsa-example">
                  <div class="example-step">
                    <h5>1. Chọn hai số nguyên tố p và q</h5>
                    <div class="step-content">
                      <p>p = 17 và q = 11</p>
                    </div>
                  </div>

                  <div class="example-step">
                    <h5>2. Tính n và φ(n)</h5>
                    <div class="step-content">
                      <p>n = p × q = 17 × 11 = 187</p>
                      <p>φ(n) = (p-1) × (q-1) = 16 × 10 = 160</p>
                    </div>
                  </div>

                  <div class="example-step">
                    <h5>3. Chọn e (số nguyên tố cùng nhau với φ(n))</h5>
                    <div class="step-content">
                      <p>e = 7 (vì GCD(7,160) = 1)</p>
                      <div class="note">
                        <i class="fas fa-info-circle"></i>
                        e phải thỏa mãn: 1 < e < φ(n) và GCD(e,φ(n)) = 1
                      </div>
                    </div>
                  </div>

                  <div class="example-step">
                    <h5>4. Tính d (nghịch đảo modulo của e theo modulo φ(n))</h5>
                    <div class="step-content">
                      <p>d × e ≡ 1 (mod φ(n))</p>
                      <p>d × 7 ≡ 1 (mod 160)</p>
                      <p>d = 23 (vì 23 × 7 = 161 ≡ 1 (mod 160))</p>
                    </div>
                  </div>

                  <div class="example-step">
                    <h5>5. Kết quả: Cặp khóa RSA</h5>
                    <div class="step-content">
                      <div class="key-pair">
                        <div class="key-box public">
                          <span class="key-label">Khóa công khai</span>
                          <p>(e,n) = (7,187)</p>
                        </div>
                        <div class="key-box private">
                          <span class="key-label">Khóa riêng tư</span>
                          <p>(d,n) = (23,187)</p>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="example-step">
                    <h5>6. Ví dụ mã hóa và giải mã</h5>
                    <div class="step-content">
                      <div class="encryption-example">
                        <p><strong>Giả sử muốn mã hóa số M = 88</strong></p>
                        <ol>
                          <li>
                            <strong>Mã hóa:</strong> C = M<sup>e</sup> mod n
                            <div class="calculation">
                              C = 88<sup>7</sup> mod 187 = 11
                            </div>
                          </li>
                          <li>
                            <strong>Giải mã:</strong> M = C<sup>d</sup> mod n
                            <div class="calculation">
                              M = 11<sup>23</sup> mod 187 = 88
                            </div>
                          </li>
                        </ol>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="algorithm-demo mt-5">
          <h4>Demo thuật toán</h4>
          <div class="form-group">
            <button class="btn btn-info mb-3" onclick="generateRSAKeys()">
              <i class="fas fa-sync"></i> Tạo cặp khóa mới
            </button>
          </div>
          <div class="form-group">
            <label>Khóa công khai:</label>
            <textarea class="form-control" id="publicKeyRSA" rows="4" readonly></textarea>
          </div>
          <div class="form-group">
            <label>Khóa riêng tư:</label>
            <textarea class="form-control" id="privateKeyRSA" rows="4" readonly></textarea>
          </div>
          <div class="form-group">
            <label>Plain text:</label>
            <textarea class="form-control" id="plaintextRSA" placeholder="Nhập văn bản cần mã hóa..."></textarea>
          </div>
          <div class="form-group">
            <label>Cipher text:</label>
            <textarea class="form-control" id="ciphertextRSA" readonly></textarea>
          </div>
          <div id="errorMsgRSA" class="error"></div>
          <div class="d-flex justify-content-center">
            <button class="btn btn-primary m-2" onclick="btnEncryptRSA()">
              Encrypt
            </button>
            <button class="btn btn-success m-2" onclick="btnDecryptRSA()">
              Decrypt
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="./lib/bootstrap/bootstrap.min.js"></script>
    <script src="./lib/jquery.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
    <script src="./script.js"></script>
    <script src="./js/playfair.js"></script>
    <script src="./js/caesar.js"></script>
    <script src="./js/vigerene.js"></script>
    <script src="./js/hashMD5.js"></script>
    <script src="./js/generateKeyByRSA.js"></script>
    <script src="./js/bcrypt.js"></script>
    <script src="./js/aes.js"></script>
    <script src="./js/rsa.js"></script>
    <script>
      $(document).ready(function() {
        // Ẩn tất cả các content
        $(".content").hide();
        
        // Hiển thị tab đầu tiên
        $("#ham-bam").show();
        $(".nav-link[data-target='ham-bam']").addClass('active');
        
        // Xử lý click tab
        $(".nav-link").click(function(e) {
          e.preventDefault();
          
          // Remove active class
          $(".nav-link").removeClass('active');
          $(this).addClass('active');
          
          // Ẩn tất cả content
          $(".content").hide();
          
          // Hiển thị content tương ứng
          var target = $(this).data("target");
          $("#" + target).fadeIn();

          // Đóng menu trên mobile sau khi chọn tab
          if ($(window).width() < 992) {
            $('.navbar-collapse').collapse('hide');
          }
        });

        // Đóng menu khi click ra ngoài
        $(document).click(function(e) {
          if (!$(e.target).closest('.navbar').length) {
            $('.navbar-collapse').collapse('hide');
          }
        });

        // Ngăn sự kiện click trong navbar lan ra ngoài
        $('.navbar').click(function(e) {
          e.stopPropagation();
        });
      });
    </script>
    <style>
      .algorithm-explanation {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 2rem;
        margin-bottom: 2rem;
      }

      .explanation-card {
        background: white;
        border-radius: 8px;
        padding: 1.5rem;
        height: 100%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }

      .explanation-card h4 {
        color: var(--primary-color);
        margin-bottom: 1rem;
        font-weight: 600;
      }

      .explanation-card ul {
        padding-left: 1.2rem;
      }

      .explanation-card li {
        margin-bottom: 0.5rem;
      }

      .formula {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 6px;
        font-family: "Courier New", monospace;
      }

      .caesar-visual {
        margin: 1rem 0;
        text-align: center;
      }

      .algorithm-demo {
        background: white;
        border-radius: 8px;
        padding: 2rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }
    </style>
  </body>
</html>
